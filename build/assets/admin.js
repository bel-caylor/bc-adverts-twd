(()=>{"use strict";const e=window.wp.data;sessionStorage.getItem("bcad_generate_after_save")&&(sessionStorage.removeItem("bcad_generate_after_save"),setTimeout((function(){const e=window.BCAdverts.wrapperSelector||".ad-image",t=document.querySelector(e);if(!t)return alert(`❌ Couldn’t find element for selector "${e}"`);const o=t.outerHTML;fetch(window.BCAdverts.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"bc_generate_advert_image",nonce:window.BCAdverts.nonce,post_id:window.BCAdverts.post_id,html:o})}).then((e=>e.json())).then((e=>{e.success?alert("✅ Image generated!"):alert("❌ "+e.data.message)})).catch((e=>{console.error(e),alert("❌ Unexpected error")}))}),500)),document.addEventListener("click",(t=>{if("bcad-generate-btn"===t.target.id){sessionStorage.setItem("bcad_generate_after_save","1"),(0,e.dispatch)("core/editor").savePost();const t=(0,e.subscribe)((()=>{const o=(0,e.select)("core/editor").isSavingPost(),r=(0,e.select)("core/editor").isAutosavingPost();o||r||(t(),window.location.reload())}))}}))})();