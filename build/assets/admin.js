(()=>{"use strict";const e=window.wp.data;sessionStorage.getItem("bcad_generate_after_save")&&(sessionStorage.removeItem("bcad_generate_after_save"),setTimeout((async function(){const e=window.BCAdverts.wrapperSelector,t=document.querySelector(e);if(!t)return void alert(`❌ Couldn’t find element for selector "${e}"`);const o=t.outerHTML;try{const e=await fetch(window.BCAdverts.css_url),t=await e.text(),s=new FormData;s.append("action","bc_generate_advert_image"),s.append("nonce",window.BCAdverts.nonce),s.append("post_id",window.BCAdverts.post_id),s.append("css",t),s.append("html",o);const r=await fetch(window.BCAdverts.ajax_url,{method:"POST",body:s}),a=await r.json();a.success?alert("✅ Image generated!"):alert(`❌ ${a.data.message}`)}catch(e){console.error(e),alert("❌ Unexpected error occurred")}}),500)),document.addEventListener("click",(t=>{if("bcad-generate-btn"===t.target.id){sessionStorage.setItem("bcad_generate_after_save","1"),(0,e.dispatch)("core/editor").savePost();const t=(0,e.subscribe)((()=>{const o=(0,e.select)("core/editor").isSavingPost(),s=(0,e.select)("core/editor").isAutosavingPost();o||s||(t(),window.location.reload())}))}if("bcad-refresh-btn"===t.target.id){(0,e.dispatch)("core/editor").savePost();const t=(0,e.subscribe)((()=>{const o=(0,e.select)("core/editor").isSavingPost(),s=(0,e.select)("core/editor").isAutosavingPost(),r=(0,e.select)("core/editor").isEditedPostDirty();o||s||r||(t(),window.location.reload())}))}}))})();