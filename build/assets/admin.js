(()=>{"use strict";const e=window.wp.data;sessionStorage.getItem("bcad_generate_after_save")&&(sessionStorage.removeItem("bcad_generate_after_save"),setTimeout((function(){const e=window.BCAdverts.wrapperSelector,t=document.querySelector(e);if(!t)return alert(`❌ Couldn’t find element for selector “${e}”`);const o=t.outerHTML;fetch(window.BCAdverts.css_url).then((e=>e.text())).then((e=>{const t=new FormData;return t.append("action","bc_generate_advert_image"),t.append("nonce",window.BCAdverts.nonce),t.append("post_id",window.BCAdverts.post_id),t.append("css",e),t.append("html",o),fetch(window.BCAdverts.ajax_url,{method:"POST",body:t})})).then((e=>e.json())).then((e=>{e.success?alert("✅ Image generated!"):alert("❌ "+e.data.message)})).catch((e=>{console.error(e),alert("❌ Unexpected error")}))}),500)),document.addEventListener("click",(t=>{if("bcad-generate-btn"===t.target.id){sessionStorage.setItem("bcad_generate_after_save","1"),(0,e.dispatch)("core/editor").savePost();const t=(0,e.subscribe)((()=>{const o=(0,e.select)("core/editor").isSavingPost(),n=(0,e.select)("core/editor").isAutosavingPost();o||n||(t(),window.location.reload())}))}}))})();