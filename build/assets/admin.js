(()=>{"use strict";const e=window.wp.data;sessionStorage.getItem("bcad_generate_after_save")&&(sessionStorage.removeItem("bcad_generate_after_save"),setTimeout((async function(){const e=window.BCAdverts.wrapperSelector,t=document.querySelector(e);if(!t)return void alert(`❌ Couldn’t find element for selector "${e}"`);const a=t.outerHTML;try{const e=await fetch(window.BCAdverts.css_url),t=await e.text(),o=new FormData;o.append("action","bc_generate_advert_image"),o.append("nonce",window.BCAdverts.nonce),o.append("post_id",window.BCAdverts.post_id),o.append("css",t),o.append("html",a);const r=await fetch(window.BCAdverts.ajax_url,{method:"POST",body:o}),s=await r.json();s.success?alert("✅ Image generated!"):alert(`❌ ${s.data.message}`)}catch(e){console.error(e),alert("❌ Unexpected error occurred")}}),500)),document.addEventListener("click",(t=>{if("bcad-generate-btn"===t.target.id){sessionStorage.setItem("bcad_generate_after_save","1"),(0,e.dispatch)("core/editor").savePost();const t=(0,e.subscribe)((()=>{const a=(0,e.select)("core/editor").isSavingPost(),o=(0,e.select)("core/editor").isAutosavingPost();a||o||(t(),window.location.reload())}))}}))})();