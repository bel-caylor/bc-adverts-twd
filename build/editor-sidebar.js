import{registerPlugin as g}from"@wordpress/plugins";import{PluginDocumentSettingPanel as h}from"@wordpress/edit-post";import{Button as x}from"@wordpress/components";import{useSelect as T}from"@wordpress/data";var p={exports:{}},s={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=Symbol.for("react.transitional.element"),C=Symbol.for("react.fragment");function v(l,t,r){var o=null;if(r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),"key"in t){r={};for(var n in t)n!=="key"&&(r[n]=t[n])}else r=t;return t=r.ref,{$$typeof:f,type:l,key:o,ref:t!==void 0?t:null,props:r}}s.Fragment=C;s.jsx=v;s.jsxs=v;p.exports=s;var m=p.exports;const E=()=>{var n;const l=T(d=>d("core/editor").getCurrentPostType(),[]),t=((n=document.querySelector(".ad-image"))==null?void 0:n.outerHTML)??"<div>No .ad-image element found</div>",r=BCAdverts.post_id;if(console.log("üîç Sending HTML and post ID:",r,t),l!=="advert")return null;const o=()=>{const d=BCAdverts.post_id;fetch(`/wp-json/wp/v2/advert/${d}`).then(e=>e.json()).then(e=>{var u;const a=document.createElement("div");a.innerHTML=((u=e.content)==null?void 0:u.rendered)??"";const i=a.querySelector(".ad-image");if(!i){alert("‚ö†Ô∏è Could not find .ad-image section in post content.");return}const c=i.outerHTML;return console.log("üñºÔ∏è Extracted ad-image HTML:",c),fetch(BCAdverts.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"bc_generate_advert_image",nonce:BCAdverts.nonce,html:c,post_id:d})})}).then(e=>{var a;return(a=e==null?void 0:e.json)==null?void 0:a.call(e)}).then(e=>{e&&(e.success?(alert("‚úÖ Image created!"),console.log("Image URL:",e.data.url)):alert("‚ùå Error: "+e.data.message))}).catch(e=>{console.error("‚ùå Error during image generation:",e),alert("‚ùå Unexpected error. Check console.")})};return m.jsx(h,{name:"bc-adverts-panel",title:"BC Adverts Tools",className:"bc-adverts-sidebar-panel",children:m.jsx(x,{isPrimary:!0,onClick:o,children:"Generate Image"})})};g("bc-adverts-sidebar-panel",{render:E,icon:null});
